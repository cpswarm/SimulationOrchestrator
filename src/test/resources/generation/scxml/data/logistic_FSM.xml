<?xml version="1.0" encoding="UTF-8"?>
<scxml xmlns="http://www.w3.org/2005/07/scxml"
	xmlns:cpswarm="http://my.custom-actions.domain/cpswarm/CUSTOM"
	version="1.0" initial="LogisticThreads" name="logistic">

	<parallel id="LogisticThreads">
		
		<parallel id="IdleThreads">
			<state id="Idle">
			</state>
			
			<state id="IdleEventMonitoring">
				<datamodel>
					<data id="invoke"><rosmonitor><topic>cpswarm/event/mission_start</topic><msg>Bool</msg></rosmonitor>
					</data>
				</datamodel>
				<invoke type="ROS_MONITOR" />
			</state>
			
			<transition event="missionStart" target="LogisticBehavior" />
		</parallel>
	
		<!-- ******************** LOGISTIC BEHAVIOR ******************** -->
		<state id="LogisticBehavior">

			<state id="LogisticAlgoritm">
				<datamodel>
					<data id="invoke"><rosaction><name>cpswarm/cmd/logistic_algorithm</name><action>Empty</action><goal type="empty" /></rosaction>
					</data>
				</datamodel>
				<invoke type="ROS_ACTION" />
			</state>

		</state>

		<!-- ******************** EVENT MONITORING ******************** -->
		<state id="LogisticEventMonitoring">
			<datamodel>
				<data id="invoke"><rosmonitor><topic>cpswarm/event/mission_abort</topic><msg>Bool</msg></rosmonitor>
				</data>
			</datamodel>
			<invoke type="ROS_MONITOR" />
		</state>
		
		<transition event="missionAbort" target="MissionAbort" />

	</parallel>

	<!-- ******************** MISSION ABORT ******************** -->
	<state id="MissionAbort">
		<datamodel>
			<data id="invoke"><rosservice><name>cmd/mission_abort</name><srv>Empty</srv><request type="empty"/></rosservice>
			</data>
		</datamodel>
		<invoke type="ROS_SERVICE" />
	</state>

</scxml>